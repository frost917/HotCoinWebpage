<!DOCTYPE HTML>
<html>
    <head>
        <title>코인 목록</title>
    </head>
    <body>
        <p id="coinlist" style="line-height: 200%"></p>
        <script>
            fetch('/coins/get')
            .then((res) => {
                if(res.ok) {
                    return res.json();
                }
            })
            .then((data) => {
                let users = data;
                let p = document.getElementById('coinlist');
                for(let k in users) {
                    fetch('https://api.twitch.tv/kraken/users?login=' + users[k].id, {
                        headers: {
                            'Accept': 'application/vnd.twitchtv.v5+json',
                            'Client-ID': 'rzqazfzpfb7iqxk546uvrwej12f9le'
                        }
                    })
                    .then((res) => {
                        if(res.ok) {
                            return res.json();
                        }
                    })
                    .then((data) => {
                        p.innerHTML += data['users'][0]['display_name'] + '(' + users[k].id +')' + ': ' + users[k].coin + '코인' + '<br />';
                    });
                }
            });
        </script>
    </body>
</html>